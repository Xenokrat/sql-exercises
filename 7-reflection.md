# 7 Рефлексия

В эталоне:
1. Согласно эталону, в таблице `squad_battles`, столбец `outcome` - не `boolean` а текстовый, т.е.
нужно использовать `CASE ... WHEN`. Это нужно учесть не только в % побед но и при расчёте корреляции
с эффективностью тренировок.
2. История участия в отряде, в частности `retention` - не учитывает, что гном "вышел" из отряда, если
причина выхода "Death".
3. Прогрессия навыков учитывает только "боевые" навыки, а не все навыки, как в моём решении.
4. Эталон также использует некотоые дополнительные поля, которых не было в задании, такие как `total_equipment_pieces`
5. Формула для расчёта общей эффективности более сложная, но это я так понимаю всё равно на вкус исполнителя задания :).
```sql
ROUND(
    (sbs.victories::DECIMAL / NULLIF(sbs.total_battles, 0)) * 0.25 +
    (1 - (sbs.total_casualties::DECIMAL / NULLIF(smh.total_members_ever, 0))) * 0.20 +
    (smh.current_members::DECIMAL / NULLIF(smh.total_members_ever, 0)) * 0.15 +
    (seq.avg_equipment_quality::DECIMAL / 5) * 0.15 +
    (ste.avg_training_effectiveness) * 0.15 +
    (AVG(ssp.avg_skill_improvement) / 5) * 0.10,
    3
) AS overall_effectiveness_score,
```

В этот раз я более корректно использовал везде `LEFT JOIN`.

Выводы: в целом конечно в идеале иметь возможностью изучить данные, так как только основываясь
на схеме базы данных, иногда можно сделать неправильные предположения.
